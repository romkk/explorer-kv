## 初始化数据库

```shell
bash ./generate_initialize_sql.sh | mysql -uroot -proot
```

## 删除数据库中所有表

```shell
mysql -D BitcoinExplorerDB -uroot -proot -Nse 'show tables' | while read table; do mysql -uroot -proot -e 'drop table '$table -D BitcoinExplorerDB; done
```

## 清空数据库中所有表

```shell
mysql -D BitcoinExplorerDB -uroot -proot -Nse 'show tables' | while read table; do mysql -uroot -proot -e 'truncate table '$table -D BitcoinExplorerDB; done
```

## bitcoind rpc补丁

```shell
cd bitcoin-0.10.0
patch -p1 < bitcoind-bm-rpc-v0.10.0.patch
```

打补丁后，会多两个RPC命令： `bm_get_best_block`, `bm_get_block_detail`.

```
$ bitcoin-cli -testnet -conf=/data/.bitcoin/bitcoin.conf bm_get_best_block
{
    "height" : 396903,
    "hash" : "00000000ed9ccafff41c1a27683633f8d8a98ffe8d2bcc76cfeaf6c56a2b7f4b",
    "prev_hash" : "00000000f88cf832a3116f4a1e1c78e182e0a6b24f406bfd99e0890236bb9429"
}

$ bitcoind-cli -testnet -conf=/data/.bitcoin/bitcoin.conf bm_get_block_detail 396903 
{
    "hash" : "00000000ed9ccafff41c1a27683633f8d8a98ffe8d2bcc76cfeaf6c56a2b7f4b",
    "confirmations" : 1,
    "size" : 315,
    "height" : 396903,
    "version" : 3,
    "merkleroot" : "4d84be712dcdf4161318b7b046925463027b5598ac3fd3954e157bdfe39a8f19",
    "tx" : [
        {
            "hash" : "4d84be712dcdf4161318b7b046925463027b5598ac3fd3954e157bdfe39a8f19",
            "rawhex" : "01000000010000000000000000000000000000000000000000000000000000000000000000ffffffff0b03670e06062f503253482fffffffff0400f90295000000001976a914fdb9fb622b0db8d9121475a983288a0876f4de4888ac0000000000000000226a200000000000000000000000000000000000000000000000000000ffff0000000000000000000000001b6a1976a914fdb9fb622b0db8d9121475a983288a0876f4de4888ac0000000000000000326a309f2cf2151c1605006475b2e289ddc22c4421e0dba86c79c36fc72b46339cd9170f05be54c37210efba6f3718c1c5260200000000"
        }
    ],
    "time" : 1431691107,
    "nonce" : 1377226476,
    "bits" : "1d00ffff",
    "difficulty" : 1.00000000,
    "chainwork" : "0000000000000000000000000000000000000000000000040b85e9cebfafa97d",
    "previousblockhash" : "00000000f88cf832a3116f4a1e1c78e182e0a6b24f406bfd99e0890236bb9429",
    "rawhex" : "030000002994bb360289e099fd6b404fb2a6e082e1781c1e4a6f11a332f88cf800000000198f9ae3df7b154e95d33fac98557b0263549246b0b7181316f4cd2d71be844d63df5555ffff001decce16520101000000010000000000000000000000000000000000000000000000000000000000000000ffffffff0b03670e06062f503253482fffffffff0400f90295000000001976a914fdb9fb622b0db8d9121475a983288a0876f4de4888ac0000000000000000226a200000000000000000000000000000000000000000000000000000ffff0000000000000000000000001b6a1976a914fdb9fb622b0db8d9121475a983288a0876f4de4888ac0000000000000000326a309f2cf2151c1605006475b2e289ddc22c4421e0dba86c79c36fc72b46339cd9170f05be54c37210efba6f3718c1c5260200000000"
}

$ bitcoind-cli -testnet -conf=/data/.bitcoin/bitcoin.conf bm_get_block_detail 00000000ed9ccafff41c1a27683633f8d8a98ffe8d2bcc76cfeaf6c56a2b7f4b
{
    "hash" : "00000000ed9ccafff41c1a27683633f8d8a98ffe8d2bcc76cfeaf6c56a2b7f4b",
    "confirmations" : 1,
    "size" : 315,
    "height" : 396903,
    "version" : 3,
    "merkleroot" : "4d84be712dcdf4161318b7b046925463027b5598ac3fd3954e157bdfe39a8f19",
    "tx" : [
        {
            "hash" : "4d84be712dcdf4161318b7b046925463027b5598ac3fd3954e157bdfe39a8f19",
            "rawhex" : "01000000010000000000000000000000000000000000000000000000000000000000000000ffffffff0b03670e06062f503253482fffffffff0400f90295000000001976a914fdb9fb622b0db8d9121475a983288a0876f4de4888ac0000000000000000226a200000000000000000000000000000000000000000000000000000ffff0000000000000000000000001b6a1976a914fdb9fb622b0db8d9121475a983288a0876f4de4888ac0000000000000000326a309f2cf2151c1605006475b2e289ddc22c4421e0dba86c79c36fc72b46339cd9170f05be54c37210efba6f3718c1c5260200000000"
        }
    ],
    "time" : 1431691107,
    "nonce" : 1377226476,
    "bits" : "1d00ffff",
    "difficulty" : 1.00000000,
    "chainwork" : "0000000000000000000000000000000000000000000000040b85e9cebfafa97d",
    "previousblockhash" : "00000000f88cf832a3116f4a1e1c78e182e0a6b24f406bfd99e0890236bb9429",
    "rawhex" : "030000002994bb360289e099fd6b404fb2a6e082e1781c1e4a6f11a332f88cf800000000198f9ae3df7b154e95d33fac98557b0263549246b0b7181316f4cd2d71be844d63df5555ffff001decce16520101000000010000000000000000000000000000000000000000000000000000000000000000ffffffff0b03670e06062f503253482fffffffff0400f90295000000001976a914fdb9fb622b0db8d9121475a983288a0876f4de4888ac0000000000000000226a200000000000000000000000000000000000000000000000000000ffff0000000000000000000000001b6a1976a914fdb9fb622b0db8d9121475a983288a0876f4de4888ac0000000000000000326a309f2cf2151c1605006475b2e289ddc22c4421e0dba86c79c36fc72b46339cd9170f05be54c37210efba6f3718c1c5260200000000"
}
```
